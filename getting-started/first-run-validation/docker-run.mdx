---
title: "Serving Docs with Docker"
description: "Instructions on using Docker/Nginx to serve the pre-built static site. Explains advantages and gives example commands for containerized previews."
---

# Serving Docs with Docker

This guide walks you through how to serve your pre-built Dory documentation site using Docker with an Nginx web server. Using Docker and Nginx provides a lightweight, portable, and production-ready method to host your static documentation site efficiently.

---

## Why Serve with Docker and Nginx?

- **Portability**: Containerized environments ensure your docs run consistently across any host system.
- **Performance**: Nginx is a high-performance static file server optimized for low latency and low resource consumption.
- **Simplicity**: A small Docker image bundles your documentation with a ready-to-use web server.
- **Standardization**: Easily integrate into deployment pipelines or cloud container platforms.

---

## Prerequisites

Before proceeding, ensure you have the following:

- Docker installed on your machine. Follow the official Docker installation guide if needed: https://docs.docker.com/get-docker/
- Your documentation site has been built and available locally in the `dist/` directory. If not, build it using:

```bash
pnpm run build
```

- Familiarity with basic Docker commands and terminal usage.

---

## Step 1: Understand the Provided Dockerfile

The official Dory static site Dockerfile, located at `k8s/docs.Dockerfile`, serves as an example:

```dockerfile
FROM node:20-alpine AS builder

RUN corepack enable && corepack prepare pnpm@10.10.0 --activate
WORKDIR /app
COPY package.json pnpm-lock.yaml ./
RUN pnpm install --frozen-lockfile
COPY . .
RUN pnpm build

FROM nginx:alpine
COPY --from=builder /app/dist /usr/share/nginx/html
COPY --from=builder /app/k8s/config/nginx-default.conf /etc/nginx/conf.d/default.conf
EXPOSE 80

CMD ["nginx", "-g", "daemon off;"]
```

### Explanation:
- The first stage (`builder`) sets up Node.js and builds the static site into `/app/dist`.
- The second stage uses the lightweight Nginx Alpine image to serve the static files.
- Custom Nginx configuration is copied for appropriate static file handling.
- Port 80 is exposed for HTTP traffic.

---

## Step 2: Build the Docker Image

From your project root where the `k8s/Dockerfile` or `k8s/docs.Dockerfile` resides, run:

```bash
docker build -f k8s/docs.Dockerfile -t dory-docs:latest .
```

**What happens?**
- Docker executes the multi-stage build.
- The final image contains Nginx serving your fully built docs.

<Tip>
Ensure your `dist/` directory is fresh before building, or rely on Dockerfile rebuild processes to regenerate it.
</Tip>

---

## Step 3: Run the Docker Container

Run the container to serve your site locally:

```bash
docker run --rm -p 8080:80 dory-docs:latest
```

- Maps container port 80 to your local port 8080.
- The site will be accessible at: http://localhost:8080

<Check>
Visit this URL in your browser to verify your documentation loads correctly.
</Check>

---

## Step 4: Customize `.dockerignore` for Efficient Builds

The included `.dockerignore` file excludes unnecessary files from the build context:

```
.git
*Dockerfile*
node_modules
k8s/Dockerfile
```

This speeds up Docker builds by ignoring irrelevant files like Git metadata and local dependencies.

---

## Tips for Production Deployment

- **Use a version tag:** Build your image with a version tag (e.g., `dory-docs:v1.0.0`) to manage releases cleanly.

- **Reverse proxy:** When deploying behind proxies or load balancers, configure Nginx headers accordingly.

- **Serve HTTPS:** Use a proxy or sidecar container to add SSL termination.

- **Static assets caching:** Customize Nginx config (`nginx-default.conf`) to leverage caching headers for faster load.

- **Health Checks:** Add Docker health checks in your production setup to monitor container status.

---

## Common Pitfalls & Troubleshooting

<AccordionGroup title="Troubleshooting Serving Docs with Docker">
<Accordion title="Docker build is slow or includes too many files">
Review your `.dockerignore` file to exclude large or unnecessary files. Avoid copying `node_modules` unless needed.
</Accordion>

<Accordion title="Site shows 404 errors when served">
Verify that the build output exists in the `/dist` folder before running the Docker build. Also, confirm that the Nginx config (`nginx-default.conf`) correctly points to `/usr/share/nginx/html`.
</Accordion>

<Accordion title="Port 8080 is already in use">
Choose a different port mapping when running the container, e.g., `-p 9090:80`.
</Accordion>

<Accordion title="Nginx fails to start in container">
Check Docker logs for syntax or permission errors. Validate the `nginx-default.conf` file syntax.
</Accordion>
</AccordionGroup>

---

## Summary

By following this guide, you have successfully packaged and served your Dory-generated static documentation using Docker and Nginx. This approach provides a portable, efficient, and production-ready static site server ready to deploy anywhere Docker containers run.

---

## Additional Resources

- [Official Dory README](https://github.com/clidey/dory#readme) — for CLI usage and local development
- [Building Static Sites](../getting-started/first-run-validation/build-static-site) — build process details
- [Docker Installation (Optional)](../prerequisites-installation/install-docker) — Docker setup and concepts
- [Nginx Static File Serving Best Practices](https://nginx.org/en/docs/http/ngx_http_core_module.html#location) — customize Nginx config

---